<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Gesture Ball Control</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- MediaPipe -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    background: #0a0a0a;
  }

  video {
    display: none;
  }

  #ball {
    position: absolute;
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #fff, #00f2ff);
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    transition: left 0.08s linear, top 0.08s linear;
  }

  .hint {
    position: fixed;
    bottom: 15px;
    width: 100%;
    text-align: center;
    color: #aaa;
    font-size: 14px;
  }
</style>
</head>

<body>

<video id="video" autoplay playsinline></video>
<div id="ball"></div>
<div class="hint">âœ‹ Move hand | ðŸ™‚ Turn face</div>

<script>
const video = document.getElementById("video");
const ball = document.getElementById("ball");

/* -------- BALL STATE -------- */
let x = window.innerWidth / 2;
let y = window.innerHeight / 2;
const SPEED = 12;

/* -------- APPLY POSITION -------- */
function updateBall() {
  x = Math.max(35, Math.min(window.innerWidth - 35, x));
  y = Math.max(35, Math.min(window.innerHeight - 35, y));
  ball.style.left = x + "px";
  ball.style.top = y + "px";
}

/* -------- HANDS -------- */
const hands = new Hands({
  locateFile: f => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`
});

hands.setOptions({
  maxNumHands: 1,
  minDetectionConfidence: 0.6,
  minTrackingConfidence: 0.6
});

hands.onResults(res => {
  if (!res.multiHandLandmarks) return;

  const palm = res.multiHandLandmarks[0][9]; // palm center
  const dx = (palm.x - 0.5) * SPEED * 2;
  const dy = (palm.y - 0.5) * SPEED * 2;

  x += dx;
  y += dy;
  updateBall();
});

/* -------- FACE -------- */
const face = new FaceMesh({
  locateFile: f => `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${f}`
});

face.setOptions({
  maxNumFaces: 1,
  refineLandmarks: false,
  minDetectionConfidence: 0.6,
  minTrackingConfidence: 0.6
});

face.onResults(res => {
  if (!res.multiFaceLandmarks) return;

  const nose = res.multiFaceLandmarks[0][1];
  const dx = (nose.x - 0.5) * SPEED;
  const dy = (nose.y - 0.5) * SPEED;

  x += dx;
  y += dy;
  updateBall();
});

/* -------- CAMERA -------- */
const camera = new Camera(video, {
  onFrame: async () => {
    await hands.send({ image: video });
    await face.send({ image: video });
  },
  width: 640,
  height: 480
});

camera.start();
</script>

</body>
</html>
