<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Real Gesture UI Control</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- MediaPipe -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
  }

  body {
    background: linear-gradient(135deg, #141e30, #243b55);
    transition: background 0.8s ease;
    font-family: system-ui, sans-serif;
  }

  /* camera hidden but running */
  video {
    display: none;
  }

  .hint {
    position: fixed;
    bottom: 20px;
    width: 100%;
    text-align: center;
    color: rgba(255,255,255,0.85);
    font-size: 16px;
    letter-spacing: 0.5px;
  }
</style>
</head>

<body>

<video id="video" autoplay playsinline></video>
<div class="hint">âœ‹ Move hand LEFT or RIGHT (slow & clear)</div>

<script>
/* ---------------- CONFIG ---------------- */

const BACKGROUNDS = [
  "linear-gradient(135deg, #141e30, #243b55)",
  "linear-gradient(135deg, #ff512f, #dd2476)",
  "linear-gradient(135deg, #11998e, #38ef7d)",
  "linear-gradient(135deg, #4568dc, #b06ab3)",
  "linear-gradient(135deg, #fc466b, #3f5efb)"
];

const MOVE_THRESHOLD = 0.18;   // how much hand must move
const COOLDOWN_MS = 900;       // time between gestures

/* ---------------------------------------- */

const video = document.getElementById("video");

let startX = null;
let lastGestureTime = 0;
let bgIndex = 0;

/* --------- HANDS SETUP --------- */

const hands = new Hands({
  locateFile: f => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`
});

hands.setOptions({
  maxNumHands: 1,
  minDetectionConfidence: 0.6,
  minTrackingConfidence: 0.6
});

/* --------- CORE LOGIC --------- */

hands.onResults(results => {
  if (!results.multiHandLandmarks) {
    startX = null;
    return;
  }

  const now = Date.now();
  if (now - lastGestureTime < COOLDOWN_MS) return;

  // palm center (very stable point)
  const palmX = results.multiHandLandmarks[0][9].x;

  if (startX === null) {
    startX = palmX;
    return;
  }

  const delta = palmX - startX;

  if (Math.abs(delta) < MOVE_THRESHOLD) return;

  if (delta > 0) {
    // RIGHT swipe
    bgIndex = (bgIndex + 1) % BACKGROUNDS.length;
  } else {
    // LEFT swipe
    bgIndex = (bgIndex - 1 + BACKGROUNDS.length) % BACKGROUNDS.length;
  }

  document.body.style.background = BACKGROUNDS[bgIndex];

  startX = null;
  lastGestureTime = now;
});

/* --------- CAMERA --------- */

const camera = new Camera(video, {
  onFrame: async () => {
    await hands.send({ image: video });
  },
  width: 640,
  height: 480
});

camera.start();
</script>

</body>
</html>
